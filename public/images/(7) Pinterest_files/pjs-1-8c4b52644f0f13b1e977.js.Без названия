webpackJsonp([1],{"2mTW":function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){var t=e.contactCount,n=e.isInContactRequestsView,a=e.onClick;if(!t&&!n)return null;var r=void 0;return r=t>Z?B.a._("1000+ contact requests","messaging"):t>=K&&t<=Z?B.a._("100+ contact requests","messaging"):M.h(B.a.ngettext("{{ contactCount }} contact request","{{ contactCount }} contact requests",t),{contactCount:""+t}),D.a.createElement("div",{className:"Module ContactRequestsCount"},D.a.createElement(Y.a,{className:F()({contactRequestView:n},"isBrioFlat","contactRequestsCount","btn"),hasIcon:n,hasText:!0,onClick:a,text:r,type:"borderless"}))}function s(e){var t=e.contactRequests,n=e.handleCancelViewContactRequests;return t?D.a.createElement("div",{className:"Module ContactRequestsCount"},D.a.createElement(X,{contactCount:t.length,isInContactRequestsView:!0,onClick:n}),D.a.createElement(q.b,{padding:2},D.a.createElement(q.H,{size:"sm"},B.a._("These messages appear from people outside of your networks.","contact requests disclaimer"))),t.map(function(e,t){return D.a.createElement("div",{key:e.id},0!==t?J:null,D.a.createElement(V,e))})):null}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function p(e){var t=e.viewer;return{viewerId:t.isAuth?t.id:null}}function d(e){var t=e.contactItem,n=e.currentUserID,a=e.conversationItem,r=e.handleContactWrapperClick,o=e.isSelected,i=e.isUser,s=["selectionIndicator","contactCircleRep","selectionIndicator"];return D.a.createElement("a",{className:"conversationContactContainer",key:a.id,onClick:function e(){return r(i,t)},onKeyDown:function e(){},role:"button",tabIndex:0},me(n,a),o?D.a.createElement("div",{className:s.join(" ")},fe):null)}function m(e){var t=e.tokenizedItems;return P.createElement("div",{className:"reactTokenizedInputContainer",style:{zIndex:1e3}},P.createElement("div",{className:"tokenContainer"},t.map(function(e,t){return P.createElement("div",{className:"tokenItem",key:t},e.full_name?P.createElement($.a,{size:"small",users:[e]}):P.createElement($.a,{emails:[e],size:"small"}))})),ve)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function v(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function E(e){var t=e.boardInvites;return t?D.a.createElement("div",null,t.map(function(e){return D.a.createElement(Ce,{boardInviteItem:e,key:e.id})})):null}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function I(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function N(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function T(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function S(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function R(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var P=n("OVW8"),D=n.n(P),L=n("DUIN"),M=n("5tOk"),B=n("W/Cr"),W=n("IaRT"),H=n.n(W),U=n("ZtCB"),A=n.n(U),q=n("gEaE"),V=function(e){function t(){var n,o,i;a(this,t);for(var s=arguments.length,c=Array(s),l=0;l<s;l++)c[l]=arguments[l];return n=o=r(this,e.call.apply(e,[this].concat(c))),o.state={contactRequestCompleted:!1,isAcceptButtonLoading:!1,isIgnoreButtonLoading:!1},o.handleInviteAcceptResponse=function(){o.setState({isAcceptButtonLoading:!0,isIgnoreButtonLoading:!1}),A.a.create("ContactRequestAcceptResource",{contact_request:o.props}).callUpdate().then(function(){o.setState({contactRequestCompleted:!0,isAcceptButtonLoading:!1})})},o.handleInviteDeclineResponse=function(){o.setState({isAcceptButtonLoading:!1,isIgnoreButtonLoading:!0}),A.a.create("ContactRequestIgnoreResource",{contact_request:o.props}).callDelete().then(function(){o.setState({contactRequestCompleted:!0,isIgnoreButtonLoading:!1})})},i=n,r(o,i)}return o(t,e),t.prototype.renderRequestText=function e(t,n,a){if(t){var r=t.name,o=t.url;return M.h(B.a._('<a href="/{{ senderUsername }}/">{{ senderName }}</a> invited you to collaborate on <a href="{{ boardUrl }}">{{ boardName }}</a>'),{boardName:r,boardUrl:o,senderName:n,senderUsername:a})}return M.h(B.a._('<a href="/{{ senderUsername }}/">{{ senderName }}</a> wants to send a message to you'),{senderName:n,senderUsername:a})},t.prototype.render=function e(){var t=this.state,n=t.contactRequestCompleted,a=t.isAcceptButtonLoading,r=t.isIgnoreButtonLoading;if(n)return null;var o=this.props,i=o.board,s=o.sender,c=s.image_large_url,l=s.full_name,u=s.username;return D.a.createElement(q.b,{paddingX:2,paddingY:4,display:"flex"},D.a.createElement(q.b,{height:50,width:50,flex:"none"},D.a.createElement(q.t,{href:"/"+u+"/"},D.a.createElement(q.a,{name:u,src:c}))),D.a.createElement(q.b,{paddingX:3},D.a.createElement(q.b,{marginBottom:3},D.a.createElement(q.H,null,D.a.createElement("span",{dangerouslySetInnerHTML:{__html:this.renderRequestText(i,l,u)}}))),D.a.createElement(q.b,{display:"flex",marginLeft:-1,marginRight:-1},D.a.createElement(q.b,{paddingX:1,flex:"grow"},D.a.createElement(q.c,{disabled:r,onClick:this.handleInviteDeclineResponse,size:"sm",text:B.a._("Ignore","ignore contact request")})),D.a.createElement(q.b,{paddingX:1,flex:"grow"},D.a.createElement(q.c,{color:"red",disabled:a,onClick:this.handleInviteAcceptResponse,size:"sm",text:B.a._("Accept","accept contact request")})))))},t}(P.Component),z=n("GGB8"),F=n.n(z),Y=n("nM9s"),G=n("JKYN"),K=100,Z=1e3,X=Object(G.b)({name:"ContactRequestsCountGetResource",key:"contactCount"},{allowStale:!1})(i),J=D.a.createElement(q.i,null),Q=Object(G.b)({name:"ContactRequestsResource",key:"contactRequests"},{allowStale:!1})(s),$=n("NYeZ"),ee=n("dnEF"),te=n("tmfO"),ne=n("Kqaz"),ae=n("/S3G"),re=n("MQ2h"),oe=n.n(re),ie=n("Vfgg"),se=n("dCTv"),ce=n("fvzG"),le=50,ue=D.a.createElement("span",{className:"conversationUnreadMark"}),pe=function(e){function t(){var n,a,r;c(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return n=a=l(this,e.call.apply(e,[this].concat(i))),a.state={isHidden:!1,unread:a.props.data.unread||0},a.handleHideConversation=function(e){e.stopPropagation();var t=a.props.data.id;A.a.create("ConversationResource",{conversation_id:t}).callDelete({showError:!1}),a.removeConversationChatHead(t),a.setState({isHidden:!0}),a.logConversationItemHide(t)},a.handleConversationItemClick=function(){var e=a.props.data;a.setState({unread:0}),e.board||a.showConversationChatHead(e),a.logConversationItemClick()},a.logConversationItemClick=function(){(0,a.props.contextLog)(101,{component:54,element:277})},a.logConversationItemHide=function(e){(0,a.props.contextLog)(182,{component:54,element:277,conversation_id:e})},r=n,l(a,r)}return u(t,e),t.prototype.showConversationChatHead=function e(t){var n=this.props.dispatch,a=t.id;n(Object(ce.e)(a)),n(Object(ce.d)(a)),n(ae.a)},t.prototype.removeConversationChatHead=function e(t){var n=this.props.dispatch;n(Object(ce.c)(t)),n(Object(ce.a)(t))},t.prototype.renderConversationsTitleNames=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).map(function(e,t){return D.a.createElement(te.b,{to:"/"+e.username+"/",key:t},e.first_name)}).concat(t.map(function(e,t){return D.a.createElement("span",{key:t},e)}));return D.a.createElement("div",{className:"membersTitleNames"},n.map(function(e,t){var a=B.a._(", ","comma separating conversation member names");return D.a.createElement("span",{key:t},e,t===n.length-1?"":D.a.createElement("span",null,a))}))},t.prototype.renderConversationsTitleView=function e(t,n,a,r){var o=this.props.viewerId,i=r.filter(function(e){return e.id!==o});return D.a.createElement("h1",{className:"conversationTitleContainer"},n||this.renderConversationsTitleNames(a,i))},t.prototype.renderLastMessage=function e(t){var n=t.board,a=t.created_at,r=t.pin,o=t.sender,i=t.text,s=t.user,c=i;if(!c){var l=o.first_name;r?c=M.h(B.a._("{{ senderName }} sent a Pin","messaging"),{senderName:l}):n?c=M.h(B.a._("{{ senderName }} sent a board","messaging"),{senderName:l}):s&&(c=M.h(B.a._("{{ senderName }} sent a user profile","messaging"),{senderName:l}))}return c=Object(ie.b)(c||"",50),D.a.createElement("div",null,D.a.createElement("div",{className:"lastMessageContent"},c),D.a.createElement("div",{className:"lastMessageTimestamp"},B.a.getHumanizedTimesince(a)))},t.prototype.renderItemContent=function e(){var t=this.state.isHidden,n=this.props.data,a=n.board,r=n.emails,o=n.last_message,i=n.name,s=n.users,c=r||[];return D.a.createElement("div",{className:F()("ConversationListItemReact",{conversationHidden:t})},D.a.createElement("div",{className:"conversationRepContainer"},D.a.createElement($.a,{board:a,emails:c,users:s})),D.a.createElement("div",{className:"conversationContentContainer"},this.renderConversationsTitleView(a,i,c,s),o?this.renderLastMessage(o):null),this.state.unread>0?ue:null,D.a.createElement(Y.a,{className:"conversationCloseButton",hasText:!0,onClick:this.handleHideConversation,text:B.a._("Ã—","close button"),type:"borderless"}))},t.prototype.render=function e(){var t=this.props.data,n=t.board;return t.users.length?n?D.a.createElement(te.b,{onClick:this.handleConversationItemClick,to:n.url},this.renderItemContent()):D.a.createElement("div",{onClick:this.handleConversationItemClick,role:"button"},this.renderItemContent()):null},t}(P.Component);pe.contextTypes={userAgent:H.a.shape({isMobile:H.a.bool.isRequired}).isRequired};var de=Object(re.compose)(Object(L.connect)(p),ne.a,Object(se.b)())(pe),me=function e(t,n){var a=n.emails,r=n.users,o=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(t&&0!==t.length){var n=t[0];return D.a.createElement("div",{className:"contactWrapper"},D.a.createElement($.a,{emails:[n],size:"small"}),D.a.createElement("div",{className:"contactTextInfo"},D.a.createElement("span",{className:"contactName"},n),D.a.createElement("span",{className:"contactDescription"},B.a._("Email friend","on selected contact list"))))}},i=function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=n[0].id===t?n[1]:n[0],r=a.full_name;return D.a.createElement("div",{className:"contactWrapper"},D.a.createElement($.a,{size:"small",users:[a]}),D.a.createElement("div",{className:"contactTextInfo"},D.a.createElement("span",{className:"contactName"},r),D.a.createElement("span",{className:"contactDescription"},B.a._("On Pinterest","info about a contact"))))};return D.a.createElement("div",null,a&&a.length>0?o(a):i(r))},fe=D.a.createElement("em",null);d.defaultProps={isSelected:!1};var he=n("tZWC"),ve=P.createElement("div",{className:"textFieldContainer"}),ye=8,ge=2,be=function(e){function t(){var n,a,r;f(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return n=a=h(this,e.call.apply(e,[this].concat(i))),a.state={contactCounter:0,selectedEmails:{},selectedUsers:{},tokenizedItems:[],value:""},a.onHandleContactClick=function(e,t){var n=a.state,r=n.selectedEmails,o=n.selectedUsers,i=e?o:r,s=e?t.id:t,c=i[s];i[s]=!c,c?a.removeTokenItem(t):a.addTokenItem(t)},a.getSelectedEmails=function(){var e=a.state.selectedEmails;return Object.keys(e).filter(function(t){return e[t]})},a.getSelectedUsers=function(){var e=a.state.selectedUsers;return Object.keys(e).filter(function(t){return e[t]})},a.handleTypeaheadKeyDown=function(e){var t=a.state,n=t.contactCounter,r=t.selectedEmails,o=t.selectedUsers,i=t.tokenizedItems,s=t.value;if(e.keyCode===ye&&n&&!s){var c=i.pop(),l=!!c.id,u=c.id||c;(l?o:r)[u]=!1,a.setState({contactCounter:n-1,tokenizedItems:i})}},a.handleInviteItemClick=function(e,t){var n=a.state,r=n.selectedUsers,o=n.selectedEmails,i=e?r:o,s=t.id||t;i[s]||(i[s]=!0,a.addTokenItem(t))},a.handleSendMessage=function(){var e=a.getSelectedEmails(),t=a.getSelectedUsers(),n=a.props.dispatch;A.a.create("ConversationsResource",{user_ids:t,emails:e,text:null}).callCreate().then(function(e){var t=e&&e.resource_response.data.id;n(Object(ce.e)(t)),n(Object(ce.d)(t))})},a.addTokenItem=function(e){var t=a.state,n=t.contactCounter,r=t.tokenizedItems;a.setState({contactCounter:n+1,tokenizedItems:r.concat([e]),value:""})},a.removeTokenItem=function(e){var t=a.state,n=t.contactCounter,r=t.tokenizedItems;n-=1,e.id?(r=r.filter(function(t){return t.id!==e.id}),a.setState({contactCounter:n,tokenizedItems:r})):a.setState({contactCounter:n,tokenizedItems:(r||[]).filter(function(t){return t!==e})})},a.renderSendMessageButton=function(){return D.a.createElement(Y.a,{className:"sendNewMessageButton",hasText:!0,onClick:a.handleSendMessage,showText:!0,text:B.a._("Next","open the new chat"),type:"borderless"})},a.renderCancelMessageButton=function(){var e=a.props.handleCancelNewMessageClick;return D.a.createElement(Y.a,{className:"cancelNewMessageView cancelButton",hasText:!0,onClick:e,showText:!0,text:B.a._("Cancel","cancel new message view"),type:"borderless"})},r=n,h(a,r)}return v(t,e),t.prototype.getContactItem=function e(t,n,a){var r=t.emails,o=t.users;return a&&o?o[0].id===n?o[1]:o[0]:r[0]},t.prototype.render=function e(){var t=this,n=this.props,a=n.conversationItems,r=n.viewerId,o=this.state,i=o.contactCounter,s=o.selectedUsers,c=o.selectedEmails,l=o.value,u=new Set,p=a.map(function(e,n){var a=e.emails,o=e.users;a||(a=[]),o||(o=[]);var i=o.length+a.length;if(i>0&&i<=2){var l=0===a.length,p=t.getContactItem(e,r,l);if(p){var m=p.id||p;if(!u.has(m))return u.add(m),D.a.createElement(d,{className:"conversationContactContainer",contactItem:p,conversationItem:e,currentUserID:r,handleContactWrapperClick:t.onHandleContactClick,isSelected:s[m]||c[m],isUser:l,key:m+"-"+n})}}return null});return D.a.createElement("div",null,D.a.createElement(q.b,{display:"flex",justifyContent:"between",padding:3},D.a.createElement(q.H,{size:"sm",color:"gray"},B.a._("New message","conversations")),i>0?this.renderSendMessageButton():this.renderCancelMessageButton()),D.a.createElement(q.b,{color:"lightGray",display:"flex",padding:3},D.a.createElement(q.b,{display:"flex",alignItems:"center",marginRight:2},D.a.createElement(q.H,{size:"sm"},B.a._("To:","new message"))),D.a.createElement(q.b,{display:"flex",position:"relative",flex:"grow"},D.a.createElement(m,{tokenizedItems:this.state.tokenizedItems}),D.a.createElement(he.a,{changeOnTextHover:!1,className:"reactNewMessageTypeahead",onChange:function e(n){return t.setState({value:n})},onInviteItemClick:this.handleInviteItemClick,onKeyDown:this.handleTypeaheadKeyDown,showInputPlaceholder:!1,value:this.state.value}))),l?null:D.a.createElement("div",{className:"contactsContainer"},p))},t}(P.Component),Ee=function e(t){return{viewerId:t.viewer.id}},we=Object(re.compose)(Object(L.connect)(Ee))(be),Ce=function(e){function t(){var n,a,r;y(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return n=a=g(this,e.call.apply(e,[this].concat(i))),a.state={boardInviteAccepted:!1,boardInvitePending:!0,isAcceptButtonLoading:!1,isIgnoreButtonLoading:!1},a.handleInviteResponse=function(e){var t=a.props.boardInviteItem,n=t.board,r=void 0===n?{}:n,o=t.invited_user,i=void 0===o?{}:o;a.setState({isAcceptButtonLoading:e,isIgnoreButtonLoading:!e});var s={board_id:r.id,invited_user_id:i.id},c=A.a.create("BoardInviteResource",s);(e?c.callUpdate():c.callDelete()).then(function(){a.setState({boardInviteAccepted:e,boardInvitePending:!1,isAcceptButtonLoading:!1,isIgnoreButtonLoading:!1})})},r=n,g(a,r)}return b(t,e),t.prototype.getBoardRep=function e(t,n){return D.a.createElement("div",{className:"leftObjectWrapper boardRepWrapper"},D.a.createElement("div",{className:"Image Module boardMessageRep"},D.a.createElement("div",{className:"heightContainer"},D.a.createElement("img",{alt:t,src:n}))))},t.prototype.getBoardInfo=function e(t,n){return D.a.createElement("a",{href:n},D.a.createElement("div",{className:t},t))},t.prototype.getInviteeInfo=function e(t){var n=t.full_name;return D.a.createElement("div",{className:"inviterLine"},Object(M.h)(B.a._("{{ fullName }} invited you to this board"),{fullName:n}))},t.prototype.renderPendingLayout=function e(t,n){var a=this,r=t.image_thumbnail_url,o=t.name,i=t.url;return D.a.createElement("div",{className:"pending"},D.a.createElement("div",{className:"left"},this.getBoardRep(o,r),D.a.createElement("div",{className:"description"},this.getBoardInfo(o,i),this.getInviteeInfo(n))),D.a.createElement("div",{className:"actions"},D.a.createElement(Y.a,{className:"remove",loading:this.state.isIgnoreButtonLoading,onClick:function e(){return a.handleInviteResponse(!1)},text:B.a._("Ignore","ignore board invite")}),D.a.createElement(Y.a,{className:F()("primary","accept"),loading:this.state.isAcceptButtonLoading,onClick:function e(){return a.handleInviteResponse(!0)},text:B.a._("Accept","accept board invite")})))},t.prototype.renderCompletedLayout=function e(t){var n=t.image_thumbnail_url,a=t.name,r=t.url;return D.a.createElement("div",{className:"success displayed"},D.a.createElement("div",{className:"left"},this.getBoardRep(a,n),D.a.createElement("div",{className:"description"},this.getBoardInfo(a,r),D.a.createElement("div",{className:"inviterLine"},B.a._("You joined this board","board invites")))))},t.prototype.render=function e(){if(!this.state.boardInvitePending&&!this.state.boardInviteAccepted)return null;var t=this.props.boardInviteItem,n=t.board,a=t.invited_by_user;return D.a.createElement("div",{className:"BoardInvite Module news"},this.state.boardInvitePending?this.renderPendingLayout(n,a):this.renderCompletedLayout(n))},t}(P.Component),_e=Object(G.b)({name:"BoardInvitesResource",key:"boardInvites",options:{current_user:!0,field_set_key:"news"}},{allowStale:!1})(E),Ie=n("nX0T"),Ne=500,Te="existingConversationsView",Oe="newMessageView",xe="contactRequestsView",Se=D.a.createElement("div",{className:"icon"}),ke=D.a.createElement("div",{className:"boardInvitesContainer"},D.a.createElement(_e,null)),je=function(e){function t(){var n,a,r;w(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return n=a=C(this,e.call.apply(e,[this].concat(i))),a.state={currentView:Te},a.handleCancelSecondaryView=function(){a.setState({currentView:Te})},a.handleNewMessageButtonClick=function(){a.setState({currentView:Oe}),a.logNewMessageButtonClick()},a.handleViewContactRequestsClick=function(){a.setState({currentView:xe})},a.handleScroll=function(){a.props.isFetching||(a._container&&a._container.scrollHeight-a._container.scrollTop-a._container.clientHeight)<Ne&&a.fetchMore()},a.logNewMessageButtonClick=function(){(0,a.props.contextLog)(101,{component:54,element:275})},r=n,C(a,r)}return _(t,e),t.prototype.componentDidMount=function e(){this.props.isFullAuth&&this._container.addEventListener("scroll",this.handleScroll)},t.prototype.componentWillUnmount=function e(){this._container.removeEventListener("scroll",this.handleScroll)},t.prototype.fetchMore=function e(){var t=this.props,n=t.isAtEnd,a=t.isFetching,r=t.fetchMoreData,o=t.isFullAuth;!a&&o&&(n?this._container.removeEventListener("scroll",this.handleScroll):r())},t.prototype.renderNewMessageView=function e(){var t=this.props.conversations,n=void 0===t?[]:t;return D.a.createElement("div",{className:"newMessageContainer"},D.a.createElement(we,{conversationItems:n,handleCancelNewMessageClick:this.handleCancelSecondaryView}))},t.prototype.renderContactRequestsView=function e(){return D.a.createElement("div",{className:"contactRequestsContainer"},D.a.createElement(Q,{handleCancelViewContactRequests:this.handleCancelSecondaryView}))},t.prototype.renderEmptyMessagesNewMessageUpsell=function e(){return D.a.createElement("div",{className:"EmptyConversations Module"},Se,D.a.createElement("div",{className:"intro"},D.a.createElement("div",null,B.a._("Send messages to your friends!")),D.a.createElement("div",null,B.a._("Plan projects, swap ideas and share your best discoveries."))))},t.prototype.renderExistingConversationsView=function e(){var t=this.props,n=t.conversations,a=void 0===n?[]:n,r=t.isAtEnd;return D.a.createElement("div",{className:"existingConversationsContainer"},D.a.createElement("div",{className:"newMessageButtonContainer"},D.a.createElement(Y.a,{className:"createConversationTab",hasIcon:!0,onClick:this.handleNewMessageButtonClick,text:B.a._("New message"),type:"borderless"})),D.a.createElement("div",{className:"viewContactRequestsButtonContainer"},D.a.createElement(X,{onClick:this.handleViewContactRequestsClick})),D.a.createElement("div",{className:"existingConversationItemsWrapper"},ke,D.a.createElement("ul",{className:"conversationItems"},0===a.length&&r?this.renderEmptyMessagesNewMessageUpsell():a.map(function(e){return D.a.createElement("li",{className:"conversationItemWrapper",key:e.id},D.a.createElement(de,{data:e}))}))))},t.prototype.renderMessageView=function e(){switch(this.state.currentView){case Te:return this.renderExistingConversationsView();case Oe:return this.renderNewMessageView();case xe:return this.renderContactRequestsView()}},t.prototype.render=function e(){var t=this;return D.a.createElement(Ie.a,{view:42,viewParameter:203},D.a.createElement("div",{className:"conversationPanel",ref:function e(n){t._container=n}},this.renderMessageView()))},t}(P.Component),Re=function e(t){return{isFullAuth:t.viewer.isAuth&&!t.viewer.isLimitedLogin}},Pe=Object(re.compose)(Object(L.connect)(Re),ne.a,Object(G.b)({name:"ConversationsResource",key:"conversations"}))(je),De=n("SnoN"),Le={ONE:1,TWO:2,END:3},Me=function(e){function t(){var n,a,r;I(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return n=a=N(this,e.call.apply(e,[this].concat(i))),a.state={educationStep:Le.ONE},a.toStepTwo=function(){a.setState({educationStep:Le.TWO})},a.dismissEducation=function(){var e=a.props.handleDismiss;a.setState({educationStep:Le.END}),e()},r=n,N(a,r)}return T(t,e),t.prototype.componentDidMount=function e(){var t=this,n=this.props.stepDelay;this.educationStepTimer=setTimeout(function(){t.state.educationStep<Le.TWO&&t.setState({educationStep:Le.TWO})},n)},t.prototype.componentWillUnmount=function e(){clearTimeout(this.educationStepTimer)},t.prototype.renderPill=function e(t,n,a){return D.a.createElement("button",{onClick:a,className:F()("educationPill","slideIn",{fadeOut:n})},D.a.createElement("div",{className:"message"},t))},t.prototype.render=function e(){var t=this.state.educationStep,n=this.props,a=n.titleText,r=n.titleText2,o=this.renderPill(a,t===Le.TWO,this.toStepTwo),i=this.renderPill(r,t===Le.END,this.dismissEducation);return D.a.createElement("div",{className:"newsHubEducation"},D.a.createElement("div",{className:"educationStep stepOne"},(t===Le.ONE||t===Le.TWO)&&o),D.a.createElement("div",{className:"educationStep stepTwo bottom"},(t===Le.TWO||t===Le.END)&&i))},t}(P.Component),Be=n("zFaW"),We=n("7Dxt"),He=Object(We.a)(Be.a),Ue=n("mnfW"),Ae=n("RvAN"),qe=n("mHth"),Ve=n("YZkw"),ze=4,Fe=864e5,Ye=function(e){function t(n){O(this,t);var a=x(this,e.call(this,n));return a.state={shouldEducate:!1},a.onDataFetched=function(e){a.props.experience&&e>ze&&!a.state.shouldEducate&&a.setState({shouldEducate:!0})},a.handleItemClick=function(){a.handleComplete(),a.props.handleItemClick()},a.handleComplete=function(){var e=a.props,t=e.experienceClient,n=e.experience;n&&t.completeExperience(n.placement_id,n.experience_id)},a.handleDismiss=function(){var e=a.props,t=e.experienceClient,n=e.experience;n&&t.dismissExperience(n.placement_id,n.experience_id)},a.renderItem=function(e,t){var n={impressionAuxFields:{displayMode:e.encoded_display_mode,newsType:e.news_type},impressionType:"News",loggingId:e.id,slotIndex:t,viewParameter:3081,viewType:107};return D.a.createElement("li",{className:"newsHubItemWrapper",key:t},a.renderDate(e.last_updated_at,t),D.a.createElement(He,Object.assign({contentItemCount:e.content_item_count,contentItems:e.content_items,contentText:e.content_text,displayMode:e.encoded_display_mode,handleClick:a.handleItemClick,headerIconImageUrl:e.header_icon_image_url,headerIconObjects:e.header_icon_objects,headerText:e.header_text,id:e.id,lastUpdatedAt:e.last_updated_at,overrideClickUrl:e.override_click_url,subHeaderText:e.sub_header_text,siteType:a.props.siteType,textMapping:e.text_mapping,type:e.news_type,unread:e.unread},n)))},a.renderEmptyState=function(){return D.a.createElement(q.b,{height:400},D.a.createElement(q.b,{display:"flex",justifyContent:"center",color:"darkGray",shape:"pill",paddingY:5,margin:5},D.a.createElement(q.g,{xs:10},D.a.createElement(q.H,{bold:!0,color:"white",size:"lg"},B.a._("New! Discover ideas from your friends, followers and people who love your Pins!")))))},a.currentDay=null,a.today=new Date,a.today.setHours(0,0,0,0),a}return S(t,e),t.prototype.getChildContext=function e(){return{preloadingSupported:!0}},t.prototype.componentDidMount=function e(){var t=this.props,n=t.experience,a=t.experienceClient;n&&a.viewExperience(n.placement_id,n.experience_id),this.logPanelImpression()},t.prototype.shouldComponentUpdate=function e(t,n){if(this.state.shouldEducate===n.shouldEducate){var a=this.props.experience,r=t.experience;return(a||{}).id!==(r||{}).id}return!0},t.prototype.getEducation=function e(){var t=this.props.experience;if(this.state.shouldEducate&&t){var n=t.display_data,a=n.step_delay,r=n.title_text,o=n.title_text_2;return D.a.createElement(Me,{handleDismiss:this.handleDismiss,stepDelay:a,titleText:r,titleText2:o})}return null},t.prototype.logPanelImpression=function e(){var t=this.props.contextLog,n=De.a.getInstance(),a=n.getViewFromContext();t(13,{view:107,viewParameter:3081}),n.addViewToContext(a)},t.prototype.renderDate=function e(t,n){var a=new Date(t);if(a.setHours(0,0,0,0),0!==n&&null!==this.currentDay&&void 0!==this.currentDay){var r=this.currentDay;if(a.getTime()===r.getTime())return null}this.currentDay=a;var o=void 0;return o=a.getTime()===this.today.getTime()?B.a._("Today"):a.getTime()===new Date(this.today-864e5).getTime()?B.a._("Yesterday"):a&&a>=new Date(this.today-5184e5)?B.a.getHumanizedTimesince(a.toString()):Ue.b.formatDate(this.props.locale,a,Ue.b.DateFormatType.MONTH_DAY,!1),D.a.createElement("div",{className:"newsHubItemDate"},D.a.createElement(q.H,{bold:!0,size:"xl"},o))},t.prototype.render=function e(){return D.a.createElement(Ie.a,{view:107,viewParameter:3081},D.a.createElement("div",null,this.getEducation(),D.a.createElement(Ae.a,{className:"newsHubPanel",onDataFetched:this.onDataFetched,renderEmptyState:this.renderEmptyState,renderItem:this.renderItem,resourceName:"NewsHubResource"})))},t}(P.Component);Ye.defaultProps={handleItemClick:function e(){}},Ye.childContextTypes={preloadingSupported:H.a.bool.isRequired};var Ge=Object(re.compose)(Object(Ve.a)(1000035),ne.a,qe.a)(Ye),Ke=n("xYG1"),Ze=D.a.createElement(Pe,null),Xe=function(e){function t(){return k(this,t),j(this,e.apply(this,arguments))}return R(t,e),t.prototype.shouldComponentUpdate=function e(t,n){return this.props.currentPanel!==t.currentPanel||this.props.conversationsUnseenCount!==t.conversationsUnseenCount||this.props.newsHubCount!==t.newsHubCount},t.prototype.render=function e(){var t=this.props,n=t.conversationsUnseenCount,a=t.currentPanel,r=t.handleItemClick,o=t.locale,i=t.newsHubCount,s=t.onButtonClick,c=t.siteType,l=void 0;return a===Ke.a.NEWS_HUB?l=D.a.createElement(Ge,{handleItemClick:r,locale:o,siteType:c}):a===Ke.a.INBOX&&(l=Ze),D.a.createElement("div",{className:"NewsConversationsDropdown"},D.a.createElement(Ke.b,{conversationsUnseenCount:n,newsHubCount:i,onButtonClick:s,selectedTab:a}),D.a.createElement("div",{className:"content"},l))},t}(P.Component),Je=t.default=Xe},"7Dxt":function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){var t=Object(f.a)(e),n=function(e){function n(){var t,o,i;a(this,n);for(var s=arguments.length,c=Array(s),l=0;l<s;l++)c[l]=arguments[l];return t=o=r(this,e.call.apply(e,[this].concat(c))),o.state={impressionStarted:!1,impressionLogged:!1},o.currentNs=function(){return Date.now()*b},o.startTime=0,o.debugPinImpressions=y&&"Pin"===o.props.impressionType&&o.props.viewer.isEmployee,o.handleVisibilityChanged=function(e){var t=o.props,n=t.componentType,a=t.contextLog,r=t.contextLogData,i=t.impressionAuxFields,s=t.impressionType,c=t.loggingId,l=t.slotIndex,u=t.viewParameter,p=t.viewType,d=t.viewData;if(e<=0){var m,f,h=g[s],v=h.idType,y=o.currentNs(),b=Object.assign((m={endTime:y},m[v]=c,m.slotIndex=l,m.time=o.startTime,m.renderDuration=y-o.startTime,m),i);a(h.eventType,Object.assign({component:n,eventData:(f={},f[h.impressionType]=[b],f),view:p,viewParameter:u,viewData:d},r)),o.debugPinImpressions&&(console.log(l+" logged for "+(y-o.startTime)/1e9+"s"),o.setState({impressionStarted:!1,impressionLogged:!0}))}else o.startTime=o.currentNs(),o.debugPinImpressions&&(console.log(l+" started timer"),o.setState({impressionStarted:!0}))},i=t,r(o,i)}return o(n,e),n.prototype.render=function e(){return s.createElement(t,Object.assign({onVisibilityChanged:this.handleVisibilityChanged,debugImpressionStarted:this.debugPinImpressions?this.state.impressionStarted:void 0,debugImpressionLogged:this.debugPinImpressions?this.state.impressionLogged:void 0},this.props))},n}(s.Component);return Object(h.compose)(d.a,m.a)(n)}t.a=i;var s=n("OVW8"),c=n.n(s),l=n("IaRT"),u=n.n(l),p=n("FJZF"),d=n("Kqaz"),m=n("i0Ug"),f=n("sHx0"),h=n("MQ2h"),v=n.n(h),y=p.a.getQueryStringParams()&&p.a.getQueryStringParams().debug_impression_log,g={Article:{impressionType:"articleImpressions",idType:"articleIdStr",eventType:3829},Pin:{impressionType:"pinImpressions",idType:"pinIdStr",eventType:18},Board:{impressionType:"boardImpressions",idType:"boardIdStr",eventType:3700},Interest:{impressionType:"topicImpressions",idType:"topicIdStr",eventType:3703},Search:{impressionType:"searchImpressions",idType:"term",eventType:3803},User:{impressionType:"userImpressions",idType:"userIdStr",eventType:3704},News:{impressionType:"newsHubData",idType:"newsIdStr",eventType:4110}},b=1e6},"7IpV":function(e,t,n){"use strict";function a(e){return e===window?window.innerHeight:e.clientHeight}function r(){return void 0!==window.scrollY?window.scrollY:document.documentElement&&void 0!==document.documentElement.scrollTop?document.documentElement.scrollTop:0}function o(e){return e===window?r():e.scrollTop-e.getBoundingClientRect().top}function i(e){return e===window&&document.documentElement?document.documentElement.scrollHeight:e.scrollHeight}function s(e){return e===window?r():e.scrollTop}t.a=a,t.d=r,t.b=i,t.c=s},NYeZ:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){return l.a.createElement("img",{alt:e,className:"head",src:t})}function s(e){var t=e.viewer;return{viewerId:t.isAuth?t.id:null}}var c=n("OVW8"),l=n.n(c),u=n("DUIN"),p=n("GGB8"),d=n.n(p),m=n("IaRT"),f=n.n(m),h=3,v=[["fullWrapper"],["leftWrapper halfWrapper","rightWrapper halfWrapper isWholeHalf"],["leftWrapper halfWrapper","rightWrapper halfWrapper smallImage top","rightWrapper halfWrapper smallImage bottom"]],y=function e(t,n){var a=t.name,r=t.image_thumbnail_url;return l.a.createElement("div",{className:d()("Image","Module","boardMessageRep",n)},l.a.createElement("img",{alt:a,src:r}))},g=function e(t){function n(e){var t=e.full_name,n=e.is_default_image,a=e.image_large_url,r=e.image_medium_url,s=e.username,c=void 0===s?"":s,u=t?t[0].toUpperCase():"",p=a||r;return p&&!n?o?l.a.createElement("div",null,l.a.createElement("a",{href:"/"+c+"/"},i(t,p))):l.a.createElement("div",null,i(t,p)):l.a.createElement("div",{className:"head"},u)}var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments[2],o=arguments[3],s=["ConversationHead",t];return l.a.createElement("div",{className:s.join(" ")},l.a.createElement("div",{className:"contentContainer"},l.a.createElement("div",{className:"headWrapper"},l.a.createElement("div",{className:"imagesWrapper"},a.map(function(e,t){return l.a.createElement("div",{className:e,key:t},n(r[t]))})))))},b=function(e){function t(){return a(this,t),r(this,e.apply(this,arguments))}return o(t,e),t.prototype.getUsersToShow=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=this.props.viewerId;return void 0!==a&&(n=n.filter(function(e){return e.id!==a})),n.concat(t.map(function(e){return{full_name:e}})).slice(0,3)},t.prototype.render=function e(){var t=this.props,n=t.board,a=t.emails,r=t.shouldLink,o=t.size,i=t.users,s=this.getUsersToShow(a,i),c=s.length<=3?v[s.length-1]:[];return n?y(n,o):g(o,c,s,r)},t}(c.Component);b.defaultProps={shouldLink:!1,size:"medium"},t.a=Object(u.connect)(s)(b)},RvAN:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){var t=Object(y.b)({name:e.resourceName,options:Object.assign({page_size:e.pageSize},e.resourceOptions)})(w);return c.a.createElement(t,e)}t.a=i;var s=n("OVW8"),c=n.n(s),l=n("GGB8"),u=n.n(l),p=n("W/Cr"),d=n("IaRT"),m=n.n(d),f=n("WBZ1"),h=n.n(f),v=n("gEaE"),y=n("JKYN"),g=n("7IpV"),b={UP:"up",DOWN:"down"},E=100,w=function(e){function t(){var n,o,i;a(this,t);for(var s=arguments.length,c=Array(s),l=0;l<s;l++)c[l]=arguments[l];return n=o=r(this,e.call.apply(e,[this].concat(c))),o.handleScroll=h()(function(){if(!o.props.isFetching){var e=o.props.scrollThreshold;Object(g.b)(o._container)-Object(g.c)(o._container)-Object(g.a)(o._container)<e&&o.fetchMore()}},E),o.addEventListeners=function(e){var t=o.props.useWindow;t&&(e=window),o.removeEventListeners(),e&&(t||e.addEventListener("wheel",o.preventScroll),e.addEventListener("scroll",o.handleScroll)),o._container=e},o.preventScroll=function(e){var t=e.deltaY<0?b.UP:b.DOWN,n=o._container.scrollHeight-o._container.scrollTop-o._container.clientHeight==0,a=0===o._container.scrollTop;(t===b.DOWN&&n||t===b.UP&&a)&&e.preventDefault()},i=n,r(o,i)}return o(t,e),t.prototype.componentWillReceiveProps=function e(t){var n=t.data.length;(0,t.onDataFetched)(n)},t.prototype.componentWillUnmount=function e(){this.removeEventListeners()},t.prototype.removeEventListeners=function e(){var t=this.props.useWindow;this._container&&(t||this._container.removeEventListener("wheel",this.preventScroll),this._container.removeEventListener("scroll",this.handleScroll))},t.prototype.fetchMore=function e(){this.props.isFetching||(this.props.isAtEnd?this._container.removeEventListener("scroll",this.handleScroll):this.props.fetchMoreData())},t.prototype.render=function e(){var t=this.props,n=t.className,a=t.renderEmptyState,r=t.renderItem;return this.props.isFetching||0!==this.props.data.length?c.a.createElement("div",{className:u()(n,"listContainer"),ref:this.addEventListeners},this.props.data?c.a.createElement("ul",{className:"scrollableList"},this.props.data.map(function(e,t){return r(e,t)})):null,this.props.isAtEnd?null:c.a.createElement("div",{className:"loadingItem"},c.a.createElement(v.E,{accessibilityLabel:p.a._("Loading items"),show:this.props.isFetching}))):a()},t}(s.Component);w.defaultProps={data:[],onDataFetched:function e(){},scrollThreshold:400,useWindow:!1},i.defaultProps={pageSize:10}}});